# üìä Script de Procesamiento de Archivos Excel

Este proyecto es una aplicaci√≥n Node.js que procesa autom√°ticamente archivos Excel, extrae los datos y los env√≠a a una API REST. Est√° dise√±ado para manejar licitaciones p√∫blicas con un sistema robusto de validaci√≥n, logging y manejo de errores.

## üöÄ Caracter√≠sticas Principales

### ‚úÖ Funcionalidades Core

- **Procesamiento autom√°tico**: Detecta y procesa el archivo Excel m√°s reciente
- **Validaci√≥n robusta**: Sistema completo de validaci√≥n de datos
- **Env√≠o a API REST**: Env√≠o optimizado de datos a API externa
- **Logging estructurado**: Sistema de logs detallado con Winston
- **Manejo de errores**: Archivos con errores se mueven a directorio separado
- **Configuraci√≥n flexible**: Variables de entorno para personalizaci√≥n

### ‚úÖ Caracter√≠sticas Avanzadas

- **Mapeo autom√°tico de encabezados**: Compatibilidad con diferentes formatos de Excel
- **L√≥gica de retry**: Reintentos autom√°ticos para llamadas a la API
- **Progreso en tiempo real**: Monitoreo detallado del procesamiento
- **Ejecutable standalone**: No requiere Node.js en el servidor
- **M√©tricas de rendimiento**: An√°lisis autom√°tico de logs
- **Modo dry-run**: Validaci√≥n sin env√≠o real de datos

## üìã Requisitos del Sistema

### Requisitos M√≠nimos

- **Node.js**: 18.0.0 o superior
- **RAM**: 512MB m√≠nimo
- **Espacio**: 100MB para la aplicaci√≥n + espacio para archivos
- **Conectividad**: Acceso a internet para API REST

### Requisitos Recomendados

- **Node.js**: 20.0.0 o superior
- **RAM**: 1GB o m√°s
- **Espacio**: 500MB para la aplicaci√≥n + espacio para archivos
- **Conectividad**: Conexi√≥n estable a internet

## üõ†Ô∏è Instalaci√≥n y Configuraci√≥n

### 1. Instalaci√≥n B√°sica

```bash
# Clonar o navegar al directorio del proyecto
cd script-upload-records-to-db

# Instalar dependencias
npm install

# Configurar variables de entorno
cp env.example .env
```

### 2. Configuraci√≥n del Archivo .env

```env
# Configuraci√≥n de API REST
API_BASE_URL=http://localhost:3000/api
API_KEY=your-api-key-here
API_TIMEOUT=30000
API_RETRY_ATTEMPTS=3

# Configuraci√≥n del Directorio de Archivos
EXCEL_DIRECTORY=./excel-files
PROCESSED_DIRECTORY=./processed-files
ERROR_DIRECTORY=./error-files

# Configuraci√≥n de Logs
LOG_LEVEL=info
LOG_FILE=./logs/app.log
LOG_ENABLE_CONSOLE=true
LOG_ENABLE_PERFORMANCE=true
LOG_MAX_SIZE=5242880
LOG_MAX_FILES=5
LOG_RETENTION_DAYS=30

# Configuraci√≥n del Procesamiento
BATCH_SIZE=100
```

## üèÉ‚Äç‚ôÇÔ∏è Uso del Aplicativo

### Opci√≥n 1: Desarrollo

```bash
# Ejecutar en modo desarrollo
npm run dev

# Ejecutar en modo producci√≥n
npm run build
npm start
```

### Opci√≥n 2: Ejecutable (Recomendado)

```bash
# Construir el ejecutable
npm run build:all

# Ejecutar directamente
./bin/script-upload-records-to-db

# Instalar globalmente (requiere sudo)
sudo ./install.sh

# Instalar en directorio personal (no requiere sudo)
./install.sh -d ~/bin

# Desinstalar (requiere sudo si instalado globalmente)
sudo ./uninstall.sh
```

#### üîê Permisos y Sudo

**Instalaci√≥n Global** (`/usr/local/bin`):

- ‚úÖ Requiere `sudo` para instalaci√≥n/desinstalaci√≥n
- ‚úÖ Requiere `sudo` para comandos de configuraci√≥n
- ‚úÖ Accesible desde cualquier ubicaci√≥n
- üìÅ Archivo `.env` ubicado en `/usr/local/bin/.env`

**Instalaci√≥n Personal** (`~/bin` o directorio personal):

- ‚ùå No requiere `sudo` para instalaci√≥n/desinstalaci√≥n
- ‚ùå No requiere `sudo` para comandos de configuraci√≥n
- ‚ö†Ô∏è Requiere agregar `~/bin` al PATH: `export PATH="$HOME/bin:$PATH"`
- üìÅ Archivo `.env` ubicado en `~/bin/.env`

### Opci√≥n 3: Configuraci√≥n desde L√≠nea de Comandos

**‚ö†Ô∏è Importante**: Si instalaste el ejecutable globalmente (en `/usr/local/bin`), los comandos de configuraci√≥n requieren permisos de administrador (`sudo`).

```bash
# Mostrar ayuda
./bin/script-upload-records-to-db --help

# Ver configuraci√≥n actual
./bin/script-upload-records-to-db --config                    # Si instalado localmente
sudo ./bin/script-upload-records-to-db --config               # Si instalado globalmente

# Configurar API
./bin/script-upload-records-to-db --api-url https://api.example.com --api-key my-key
sudo ./bin/script-upload-records-to-db --api-url https://api.example.com --api-key my-key

# Configurar directorios
./bin/script-upload-records-to-db --excel-dir ./my-excel-files --processed-dir ./my-processed-files
sudo ./bin/script-upload-records-to-db --excel-dir ./my-excel-files --processed-dir ./my-processed-files

# Modo dry-run (solo validaci√≥n)
./bin/script-upload-records-to-db --dry-run

# Configuraci√≥n completa
./bin/script-upload-records-to-db \
  --api-url https://api.example.com \
  --api-key secret123 \
  --excel-dir ./production/excel \
  --batch-size 1000 \
  --log-level info

# Alternativa: Instalar en directorio personal para evitar sudo
./install.sh -d ~/bin
~/bin/excel-processor --api-url https://api.example.com --api-key my-key
```

### ‚è∞ Programaci√≥n Autom√°tica

Para ejecutar el programa autom√°ticamente en horarios espec√≠ficos:

```bash
# Usar el script de programaci√≥n (recomendado)
./setup-scheduler.sh

# Opciones disponibles:
./setup-scheduler.sh -d          # Ejecutar diariamente a las 2:00 AM
./setup-scheduler.sh -w          # Ejecutar semanalmente los domingos
./setup-scheduler.sh -c          # Configurar programaci√≥n personalizada
./setup-scheduler.sh -r          # Remover programaci√≥n existente
./setup-scheduler.sh -s          # Ver programaci√≥n actual
```

### üìú Scripts Shell Disponibles

El proyecto incluye los siguientes scripts shell para facilitar la instalaci√≥n y configuraci√≥n:

#### `install.sh` - Script de Instalaci√≥n

```bash
# Instalar el ejecutable globalmente (requiere sudo)
sudo ./install.sh

# Instalar en directorio personal (no requiere sudo)
./install.sh -d ~/bin

# Opciones disponibles:
./install.sh --help              # Mostrar ayuda
./install.sh -d <directorio>     # Especificar directorio de instalaci√≥n
```

#### `uninstall.sh` - Script de Desinstalaci√≥n

```bash
# Desinstalar el ejecutable (requiere sudo si instalado globalmente)
sudo ./uninstall.sh

# Desinstalar desde directorio personal
./uninstall.sh -d ~/bin

# Opciones disponibles:
./uninstall.sh --help            # Mostrar ayuda
./uninstall.sh -d <directorio>   # Especificar directorio de instalaci√≥n
./uninstall.sh --force           # Forzar desinstalaci√≥n sin confirmaci√≥n
```

#### `setup-scheduler.sh` - Script de Programaci√≥n

```bash
# Configurar ejecuci√≥n autom√°tica
./setup-scheduler.sh

# Opciones disponibles:
./setup-scheduler.sh -d          # Programar ejecuci√≥n diaria
./setup-scheduler.sh -w          # Programar ejecuci√≥n semanal
./setup-scheduler.sh -c          # Configuraci√≥n personalizada
./setup-scheduler.sh -r          # Remover programaci√≥n
./setup-scheduler.sh -s          # Ver programaci√≥n actual
./setup-scheduler.sh --help      # Mostrar ayuda completa
```

**Ejemplos de programaci√≥n personalizada:**

```bash
# Ejecutar cada 6 horas
0 */6 * * * excel-processor

# Ejecutar solo d√≠as laborables a las 9:00 AM
0 9 * * 1-5 excel-processor

# Ejecutar los fines de semana a las 3:00 PM
0 15 * * 6,0 excel-processor
```

## üìä Estructura de Datos

### Campos Esperados por el Sistema

| Campo del Sistema | Tipo   | Descripci√≥n               | Requerido | L√≠mite |
| ----------------- | ------ | ------------------------- | --------- | ------ |
| idLicitacion      | string | ID √∫nico de la licitaci√≥n | ‚úÖ        | 50     |
| nombre            | string | Nombre de la licitaci√≥n   | ‚úÖ        | 500    |
| fechaPublicacion  | date   | Fecha de publicaci√≥n      | ‚ùå        | -      |
| fechaCierre       | date   | Fecha de cierre           | ‚ùå        | -      |
| organismo         | string | Organismo que publica     | ‚ùå        | 300    |
| unidad            | string | Unidad del organismo      | ‚ùå        | 200    |
| montoDisponible   | number | Monto disponible          | ‚ùå        | 15,2   |
| moneda            | string | Moneda (CLP, USD, etc.)   | ‚ùå        | 10     |
| estado            | string | Estado de la licitaci√≥n   | ‚ùå        | 50     |

### Mapeo Autom√°tico de Encabezados

El sistema mapea autom√°ticamente los siguientes encabezados del Excel:

| Encabezado del Excel   | Campo del Sistema  | Variaciones Soportadas              |
| ---------------------- | ------------------ | ----------------------------------- |
| `ID`                   | `idLicitacion`     | id_licitacion, idlicitacion         |
| `Nombre`               | `nombre`           | -                                   |
| `Fecha de Publicaci√≥n` | `fechaPublicacion` | fecha_publicacion, fechapublicacion |
| `Fecha de cierre`      | `fechaCierre`      | fecha_cierre, fechacierre           |
| `Organismo`            | `organismo`        | -                                   |
| `Unidad`               | `unidad`           | -                                   |
| `Monto Disponible`     | `montoDisponible`  | monto_disponible, montodisponible   |
| `Moneda`               | `moneda`           | -                                   |
| `Estado`               | `estado`           | -                                   |

**Caracter√≠sticas del mapeo:**

- ‚úÖ Insensible a may√∫sculas/min√∫sculas
- ‚úÖ Maneja acentos y caracteres especiales
- ‚úÖ Normaliza espacios m√∫ltiples
- ‚úÖ Soporta variaciones de nombres

## üîß Configuraci√≥n Avanzada

### Variables de Entorno Detalladas

| Variable              | Descripci√≥n                          | Valor por Defecto           | Tipo   |
| --------------------- | ------------------------------------ | --------------------------- | ------ |
| `API_BASE_URL`        | URL base de la API REST              | `http://localhost:3000/api` | string |
| `API_KEY`             | Clave de autenticaci√≥n para la API   | `''`                        | string |
| `API_TIMEOUT`         | Timeout para llamadas API en ms      | `30000`                     | number |
| `API_RETRY_ATTEMPTS`  | N√∫mero de reintentos para API        | `3`                         | number |
| `EXCEL_DIRECTORY`     | Directorio a monitorear              | `./excel-files`             | string |
| `PROCESSED_DIRECTORY` | Directorio para archivos procesados  | `./processed-files`         | string |
| `ERROR_DIRECTORY`     | Directorio para archivos con errores | `./error-files`             | string |
| `LOG_LEVEL`           | Nivel de logging                     | `info`                      | string |
| `LOG_FILE`            | Archivo de logs                      | `./logs/app.log`            | string |
| `BATCH_SIZE`          | Tama√±o del lote para env√≠o           | `100`                       | number |

### Directorios Autom√°ticos

El script crea autom√°ticamente:

- `excel-files/`: Archivos Excel a procesar
- `processed-files/`: Archivos procesados exitosamente
- `error-files/`: Archivos que generaron errores
- `logs/`: Archivos de logs

## üìä Sistema de Logging

### Caracter√≠sticas del Logging

- **Categor√≠as**: Cada componente tiene su propia categor√≠a
- **Sesiones √önicas**: Rastreo de procesos individuales
- **M√©tricas de Rendimiento**: Tiempos de operaci√≥n autom√°ticos
- **Formato Estructurado**: JSON para an√°lisis automatizado
- **Rotaci√≥n Autom√°tica**: Gesti√≥n de archivos de log

### Archivos de Log

- `logs/app.log`: Logs generales con toda la informaci√≥n
- `logs/app.error.log`: Solo errores para monitoreo r√°pido
- `logs/app.performance.log`: M√©tricas de rendimiento detalladas
- `logs/report.md`: Reporte autom√°tico de an√°lisis
- `logs/report.json`: Datos estructurados para an√°lisis

### Niveles de Log

- `error`: Errores cr√≠ticos
- `warn`: Advertencias
- `info`: Informaci√≥n general
- `verbose`: Informaci√≥n detallada (m√©tricas)
- `debug`: Informaci√≥n de depuraci√≥n

### Comandos de An√°lisis

```bash
npm run logs:analyze    # Genera reporte completo
npm run logs:report     # Genera reporte y muestra resumen
npm run logs:clean      # Limpia logs antiguos (>30 d√≠as)
npm run logs:test       # Prueba el sistema de logging
```

### Ejemplo de Log Estructurado

```json
{
  "timestamp": "2025-08-22 08:38:31",
  "level": "info",
  "category": "ExcelProcessor",
  "sessionId": "session_1755869911295_dma0shv4i",
  "operation": "read_excel_file",
  "duration": 151,
  "message": "Performance: read_excel_file",
  "fileName": "test-file.xlsx",
  "recordsCount": 1000
}
```

## üîç Validaciones de Datos

### Validaciones Implementadas

#### 1. Campos Obligatorios

- **idLicitacion**: Debe estar presente y no estar vac√≠o (m√°ximo 50 caracteres)
- **nombre**: Debe estar presente y no estar vac√≠o (m√°ximo 500 caracteres)

#### 2. Campos Opcionales con Validaci√≥n

- **organismo**: Si est√° presente, m√°ximo 300 caracteres
- **unidad**: Si est√° presente, m√°ximo 200 caracteres
- **moneda**: Si est√° presente, m√°ximo 10 caracteres
- **estado**: Si est√° presente, m√°ximo 50 caracteres

#### 3. Validaci√≥n de Fechas

- **fechaPublicacion**: Formato de fecha v√°lido (opcional)
- **fechaCierre**: Formato de fecha v√°lido (opcional)
- **Rango de fechas**: La fecha de cierre debe ser posterior o igual a la fecha de publicaci√≥n

#### 4. Validaci√≥n de Montos

- **montoDisponible**: Debe ser un n√∫mero v√°lido y no negativo (opcional)
- Soporta tanto n√∫meros como strings num√©ricos
- Maneja formatos de moneda (ej: "$1,234.56")

#### 5. Validaci√≥n de Estructura

- Verifica que no haya filas `undefined` o vac√≠as
- Valida que los datos sean un array v√°lido

### M√©tricas de Validaci√≥n

- **L√≠mite de logs**: M√°ximo 10 errores detallados para evitar saturaci√≥n
- **Logs estructurados**: Incluyen n√∫mero de fila y valor problem√°tico
- **Resumen final**: Total de errores encontrados vs registros procesados

## üîÑ Manejo de Errores y Retry

### L√≥gica de Retry para API REST

#### Configuraci√≥n de Retry

```env
API_RETRY_ATTEMPTS=3              # N√∫mero m√°ximo de intentos
API_TIMEOUT=30000                 # Timeout en ms
```

#### Estrategia de Retry

- Intento 1: Env√≠o inmediato
- Intento 2: Espera 1 segundo
- Intento 3: Espera 2 segundos

### Tipos de Errores Manejados

1. **Archivo no encontrado**: No hay archivos Excel en el directorio
2. **Archivo corrupto**: El archivo Excel no se puede leer
3. **Datos inv√°lidos**: Los datos no cumplen con la estructura esperada
4. **Error de API**: Problemas de conectividad o respuesta de la API
5. **Error de permisos**: Problemas de acceso a archivos
6. **Encabezados no mapeados**: Columnas del Excel que no coinciden con el mapeo

### Recuperaci√≥n Autom√°tica

- Los archivos con errores se mueven a `error-files/`
- Los logs detallan el error espec√≠fico
- El servicio contin√∫a funcionando despu√©s de un error
- Reintentos autom√°ticos para llamadas a la API

## üìà Monitoreo y Progreso

### Progreso Detallado por Lotes

```
‚úÖ Lote 1: 100/5,000 registros (2.0%)
‚úÖ Lote 2: 200/5,000 registros (4.0%)
‚úÖ Lote 3: 300/5,000 registros (6.0%)
```

### M√©tricas de Tiempo

```
‚è±Ô∏è  Tiempo transcurrido: 45s | Estimado restante: 120s
üìä Velocidad: 1,200 registros/min
```

### Estad√≠sticas Finales

```
üéâ ¬°Env√≠o completado exitosamente!
   üìä Total de registros enviados: 5,000
   ‚è±Ô∏è  Tiempo total: 165s
   üì¶ Lotes procesados: 50
   üöÄ Velocidad promedio: 1,818 registros/min
   ‚è∞ Finalizado: 15:30:45
```

## üß™ Pruebas y Desarrollo

### Scripts de Prueba Disponibles

```bash
# Ejecutar todas las pruebas
npm test

# Ejecutar pruebas en modo watch
npm run test:watch

# Ejecutar pruebas con UI
npm run test:ui

# Ejecutar pruebas con cobertura
npm run test:coverage

# Probar configuraci√≥n del archivo .env
npm run test:env-config

# Probar integraci√≥n con API
npm run test:api

# Probar sistema de logging
npm run logs:test
```

### Scripts de Generaci√≥n de Datos

```bash
# Crear archivo Excel de prueba peque√±o
npm run test:excel

# Crear archivo Excel de prueba grande
npm run test:excel:large 10000

# Ejecutar demostraci√≥n de progreso
npm run demo
```

### Scripts Disponibles

```bash
npm run build          # Compilar TypeScript
npm run build:all      # Compilar y crear ejecutable
npm run dev            # Ejecutar en modo desarrollo
npm run start          # Ejecutar en modo producci√≥n
npm run test           # Ejecutar pruebas
npm run test:watch     # Ejecutar pruebas en modo watch
npm run test:env-config # Probar configuraci√≥n del archivo .env
npm run test:api       # Probar integraci√≥n con API
```

## üîß Soluci√≥n de Problemas

### Problemas Comunes

#### 1. Error: "No se encontraron archivos Excel"

**Causa**: No hay archivos Excel en el directorio configurado
**Soluci√≥n**:

```bash
# Verificar directorio
ls -la ./excel-files/

# Crear archivo de prueba
npm run test:excel
```

#### 2. Error: "API no disponible"

**Causa**: La API REST no est√° accesible o configuraci√≥n incorrecta
**Soluci√≥n**:

```bash
# Verificar conectividad
curl -X GET http://localhost:3000/api

# Verificar configuraci√≥n
./bin/script-upload-records-to-db --config

# Probar con modo dry-run
./bin/script-upload-records-to-db --dry-run
```

#### 3. Error: "Encabezado no mapeado"

**Causa**: Los encabezados del Excel no coinciden con el mapeo esperado
**Soluci√≥n**:

```bash
# Verificar mapeo de encabezados
node scripts/test-header-mapping.js

# Revisar logs para ver encabezados detectados
tail -f logs/app.log
```

#### 4. Error: "Permisos denegados"

**Causa**: Problemas de permisos en archivos o directorios
**Soluci√≥n**:

```bash
# Dar permisos de ejecuci√≥n
chmod +x bin/script-upload-records-to-db

# Verificar permisos de directorios
ls -la excel-files/ processed-files/ error-files/
```

#### 5. Error: "Variable de entorno requerida"

**Causa**: Falta configuraci√≥n en el archivo .env
**Soluci√≥n**:

```bash
# Crear archivo .env desde ejemplo
cp env.example .env

# Editar configuraci√≥n
nano .env
```

### Logs de Debug

```bash
# Ejecutar con nivel de log debug
LOG_LEVEL=debug npm run dev

# Ver logs en tiempo real
tail -f logs/app.log

# Ver solo errores
tail -f logs/app.error.log

# Ver m√©tricas de rendimiento
tail -f logs/app.performance.log
```

### Verificaci√≥n de Funcionalidad

```bash
# Probar ejecutable
./bin/script-upload-records-to-db --dry-run

# Verificar conectividad con API
npm run test:api

# Probar sistema de logging
npm run logs:test
```

## üìÅ Estructura del Proyecto

```
script-upload-records-to-db/
‚îú‚îÄ‚îÄ src/
‚îÇ   ‚îú‚îÄ‚îÄ config/
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ config.ts          # Configuraci√≥n general
‚îÇ   ‚îú‚îÄ‚îÄ services/
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ __tests__/
‚îÇ   ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ ExcelProcessor.test.ts
‚îÇ   ‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ HeaderMapping.test.ts
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ ApiService.ts      # Servicio para API REST
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ ExcelProcessor.ts  # L√≥gica principal de procesamiento
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ ExcelValidator.ts  # Validaci√≥n de datos
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ DataTransformer.ts # Transformaci√≥n de datos
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ FileProcessor.ts   # Manejo de archivos
‚îÇ   ‚îú‚îÄ‚îÄ cli/
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ argumentParser.ts  # Parser de argumentos CLI
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ commandHandler.ts  # Manejador de comandos
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ environmentManager.ts # Gestor de variables de entorno
‚îÇ   ‚îú‚îÄ‚îÄ utils/
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ logger.ts          # Configuraci√≥n de Winston
‚îÇ   ‚îî‚îÄ‚îÄ index.ts               # Punto de entrada principal
‚îú‚îÄ‚îÄ scripts/
‚îÇ   ‚îú‚îÄ‚îÄ create-test-excel.js
‚îÇ   ‚îú‚îÄ‚îÄ create-large-test-excel.js
‚îÇ   ‚îú‚îÄ‚îÄ demo-progress.js
‚îÇ   ‚îú‚îÄ‚îÄ log-analyzer.ts
‚îÇ   ‚îú‚îÄ‚îÄ test-api-integration.js
‚îÇ   ‚îú‚îÄ‚îÄ test-env-config.js
‚îÇ   ‚îî‚îÄ‚îÄ test-header-mapping.js
‚îú‚îÄ‚îÄ bin/                       # Ejecutables generados
‚îú‚îÄ‚îÄ logs/                      # Archivos de log
‚îú‚îÄ‚îÄ excel-files/               # Archivos Excel a procesar
‚îú‚îÄ‚îÄ processed-files/           # Archivos procesados
‚îú‚îÄ‚îÄ error-files/               # Archivos con errores
‚îú‚îÄ‚îÄ install.sh                 # Script de instalaci√≥n
‚îú‚îÄ‚îÄ uninstall.sh               # Script de desinstalaci√≥n
‚îú‚îÄ‚îÄ setup-scheduler.sh         # Script de programaci√≥n autom√°tica
‚îú‚îÄ‚îÄ package.json
‚îú‚îÄ‚îÄ tsconfig.json
‚îú‚îÄ‚îÄ vitest.config.ts
‚îî‚îÄ‚îÄ README.md
```

## üì¶ Informaci√≥n del Ejecutable

### ¬øQu√© es el ejecutable?

El ejecutable es una versi√≥n compilada del proyecto que incluye todas las dependencias necesarias. No requiere Node.js instalado en el servidor donde se ejecute.

### Caracter√≠sticas del Ejecutable

- **Portabilidad**: Funciona en cualquier sistema Linux x64
- **Autocontenido**: Incluye todas las dependencias
- **Configuraci√≥n flexible**: Usa variables de entorno o archivo .env
- **Logging completo**: Mantiene todos los logs del proyecto original

### Archivos Generados

- `bin/script-upload-records-to-db`: Ejecutable principal
- `install.sh`: Script de instalaci√≥n
- `uninstall.sh`: Script de desinstalaci√≥n

### Comandos del Ejecutable

```bash
# Construir
npm run build:all

# Ejecutar
./bin/script-upload-records-to-db

# Instalar
./install.sh

# Desinstalar
./uninstall.sh
```

## üîÑ Flujo de Procesamiento

1. **Detecci√≥n**: Busca el archivo Excel m√°s reciente
2. **Lectura**: Lee y parsea el archivo Excel
3. **Validaci√≥n**: Valida la estructura de datos
4. **Transformaci√≥n**: Convierte datos al formato esperado por la API
5. **Env√≠o**: Env√≠a registros a la API REST por lotes
6. **Movimiento**: Mueve archivo a directorio procesado
7. **Logging**: Registra todo el proceso

## üìà Rendimiento

### Optimizaciones

- **Procesamiento por lotes**: Configurable con `BATCH_SIZE`
- **Validaci√≥n eficiente**: Solo valida campos requeridos
- **Logging as√≠ncrono**: No bloquea el procesamiento
- **Manejo de memoria**: Libera recursos despu√©s de cada archivo
- **Reintentos inteligentes**: Manejo de errores de red

### Recomendaciones

- Ajusta `BATCH_SIZE` seg√∫n la capacidad de la API
- Usa `API_TIMEOUT` para controlar timeouts de red
- Monitorea los logs para detectar problemas de rendimiento
- Configura `API_RETRY_ATTEMPTS` seg√∫n la estabilidad de la API

## ü§ù Contribuci√≥n

1. Fork el proyecto
2. Crea una rama para tu feature (`git checkout -b feature/AmazingFeature`)
3. Commit tus cambios (`git commit -m 'Add some AmazingFeature'`)
4. Push a la rama (`git push origin feature/AmazingFeature`)
5. Abre un Pull Request

## üìÑ Licencia

Este proyecto est√° bajo la Licencia MIT. Ver el archivo `LICENSE` para m√°s detalles.

## üÜò Soporte

Si tienes problemas o preguntas:

1. Revisa los logs en `logs/app.log`
2. Verifica la configuraci√≥n en `.env`
3. Aseg√∫rate de que la API REST est√© accesible
4. Verifica que los archivos Excel tengan la estructura correcta
5. Usa el modo dry-run para validar sin enviar datos

## üìö Referencias T√©cnicas

### Dependencias Principales

| Dependencia         | Versi√≥n | Prop√≥sito                       |
| ------------------- | ------- | ------------------------------- |
| `axios`             | ^1.6.7  | Cliente HTTP para API REST      |
| `xlsx`              | ^0.18.5 | Procesamiento de archivos Excel |
| `winston`           | ^3.13.0 | Sistema de logging              |
| `dotenv`            | ^16.4.5 | Variables de entorno            |
| `class-transformer` | ^0.5.1  | Transformaci√≥n de datos         |
| `class-validator`   | ^0.14.1 | Validaci√≥n de datos             |

### Scripts de Build

```bash
npm run build                    # Compilar TypeScript
npm run build:executable         # Crear ejecutable
npm run build:executable:clean   # Crear ejecutable sin warnings
npm run build:all               # Compilar y crear ejecutable
npm run build:all:clean         # Build completo sin warnings
```

### Configuraci√≥n de TypeScript

```json
{
  "compilerOptions": {
    "target": "ES2020",
    "module": "commonjs",
    "lib": ["ES2020"],
    "outDir": "./dist",
    "rootDir": "./src",
    "strict": true,
    "esModuleInterop": true,
    "skipLibCheck": true,
    "forceConsistentCasingInFileNames": true,
    "experimentalDecorators": true,
    "emitDecoratorMetadata": true
  }
}
```

### Configuraci√≥n de Vitest

```typescript
import { defineConfig } from 'vitest/config';

export default defineConfig({
  test: {
    environment: 'node',
    setupFiles: ['./src/test/setup.ts'],
    globals: true,
    coverage: {
      provider: 'v8',
      reporter: ['text', 'json', 'html'],
    },
  },
});
```

---

**√öltima actualizaci√≥n**: Agosto 2025  
**Versi√≥n**: 1.0.0
